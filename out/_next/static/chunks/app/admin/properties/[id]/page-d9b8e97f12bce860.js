(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[644],{6535:function(e,r,a){Promise.resolve().then(a.bind(a,486))},486:function(e,r,a){"use strict";a.d(r,{default:function(){return d}});var t=a(7437),s=a(2265),o=a(6463),l=a(7138),n=a(2824),i=a(8311);function d(e){let{id:r}=e,a=(0,o.useRouter)(),d="new"===r,[c,u]=(0,s.useState)(!d),[p,g]=(0,s.useState)(!1),[b,m]=(0,s.useState)({title:"",location:"",price:"",type:"Buy",category:"Residential",status:"Available",image:"",images:[""],description:"",amenities:[""],specs:{area:"",beds:0,baths:0},views:0,map_address:""});(0,s.useEffect)(()=>{d||x()},[r]);let x=async()=>{try{let{data:e,error:a}=await i.O.from("properties").select("*").eq("id",r).single();if(a)throw a;m(e)}catch(e){console.error("Error fetching property:",e),alert("Failed to load property from database")}finally{u(!1)}},y=async e=>{e.preventDefault(),g(!0);try{let e;let t={...b};if(delete t.created_at,d?(delete t.id,e=await i.O.from("properties").insert([t])):e=await i.O.from("properties").update(t).eq("id",r),e.error)throw e.error;a.push("/admin/properties/")}catch(e){console.error("Error saving property:",e),alert("Error saving property to database")}finally{g(!1)}},f=(e,r,a)=>{let t=[...b[e]];t[r]=a,m({...b,[e]:t})},h=e=>{m({...b,[e]:[...b[e],""]})},v=(e,r)=>{let a=b[e].filter((e,a)=>a!==r);m({...b,[e]:a})};return c?(0,t.jsx)("div",{className:"text-center py-12",children:"Loading..."}):(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)(l.default,{href:"/admin/properties",className:"text-blue-600 hover:underline mb-4 inline-block",children:"← Back to Properties"}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:d?"Add New Property":"Edit Property"})]}),(0,t.jsxs)("form",{onSubmit:y,className:"bg-white rounded-xl shadow-sm border border-gray-100 p-8",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Title *"}),(0,t.jsx)("input",{type:"text",value:b.title,onChange:e=>m({...b,title:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Location *"}),(0,t.jsx)("input",{type:"text",value:b.location,onChange:e=>m({...b,location:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Price *"}),(0,t.jsx)("input",{type:"text",value:b.price,onChange:e=>m({...b,price:e.target.value}),placeholder:"₹ 4.5 Cr",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Type *"}),(0,t.jsxs)("select",{value:b.type,onChange:e=>m({...b,type:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none",children:[(0,t.jsx)("option",{value:"Buy",children:"Buy"}),(0,t.jsx)("option",{value:"Rent",children:"Rent"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Category *"}),(0,t.jsxs)("select",{value:b.category,onChange:e=>m({...b,category:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none",children:[(0,t.jsx)("option",{value:"Residential",children:"Residential"}),(0,t.jsx)("option",{value:"Commercial",children:"Commercial"}),(0,t.jsx)("option",{value:"Villa",children:"Villa"}),(0,t.jsx)("option",{value:"Land",children:"Land"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Status *"}),(0,t.jsxs)("select",{value:b.status,onChange:e=>m({...b,status:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none",children:[(0,t.jsx)("option",{value:"Available",children:"Available"}),(0,t.jsx)("option",{value:"Ready to Move",children:"Ready to Move"}),(0,t.jsx)("option",{value:"Under Construction",children:"Under Construction"}),(0,t.jsx)("option",{value:"New Launch",children:"New Launch"})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Main Image URL *"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"url",value:b.image,onChange:e=>m({...b,image:e.target.value}),placeholder:"https://...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none",required:!0}),(0,t.jsx)(n.Z,{onUploadSuccess:e=>m({...b,image:e}),buttonText:"\uD83D\uDCF8 Upload"})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Map Address"}),(0,t.jsx)("input",{type:"text",value:b.map_address,onChange:e=>m({...b,map_address:e.target.value}),placeholder:"Full address for Google Maps",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Description *"}),(0,t.jsx)("textarea",{value:b.description,onChange:e=>m({...b,description:e.target.value}),rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none",required:!0})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Gallery Images"}),b.images.map((e,r)=>(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,t.jsx)("input",{type:"url",value:e,onChange:e=>f("images",r,e.target.value),placeholder:"https://...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none"}),(0,t.jsx)(n.Z,{onUploadSuccess:e=>f("images",r,e),buttonText:"\uD83D\uDCF8",buttonClass:"px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"}),(0,t.jsx)("button",{type:"button",onClick:()=>v("images",r),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600",children:"Remove"})]},r)),(0,t.jsx)("button",{type:"button",onClick:()=>h("images"),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-bold",children:"+ Add Image"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Amenities"}),b.amenities.map((e,r)=>(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,t.jsx)("input",{type:"text",value:e,onChange:e=>f("amenities",r,e.target.value),placeholder:"Swimming Pool",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none"}),(0,t.jsx)("button",{type:"button",onClick:()=>v("amenities",r),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600",children:"Remove"})]},r)),(0,t.jsx)("button",{type:"button",onClick:()=>h("amenities"),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-bold",children:"+ Add Amenity"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Area"}),(0,t.jsx)("input",{type:"text",value:b.specs.area,onChange:e=>m({...b,specs:{...b.specs,area:e.target.value}}),placeholder:"4500 Sq. Ft.",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Bedrooms"}),(0,t.jsx)("input",{type:"number",value:b.specs.beds,onChange:e=>m({...b,specs:{...b.specs,beds:parseInt(e.target.value)||0}}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Bathrooms"}),(0,t.jsx)("input",{type:"number",value:b.specs.baths,onChange:e=>m({...b,specs:{...b.specs,baths:parseInt(e.target.value)||0}}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent outline-none"})]})]}),(0,t.jsxs)("div",{className:"mt-8 flex gap-4",children:[(0,t.jsx)("button",{type:"submit",disabled:p,className:"px-8 py-3 bg-[var(--primary)] text-black font-bold rounded-lg hover:bg-black hover:text-white transition-colors disabled:opacity-50",children:p?"Saving...":"Save Property"}),(0,t.jsx)(l.default,{href:"/admin/properties",className:"px-8 py-3 bg-gray-200 text-gray-700 font-bold rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"})]})]})]})}},2824:function(e,r,a){"use strict";a.d(r,{Z:function(){return l}});var t=a(7437),s=a(2265),o=a(357);function l(e){let{onUploadSuccess:r,folder:a="prem-properties",buttonText:l="Upload Image",buttonClass:n="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-bold"}=e,[i,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(window.cloudinary){u(!0);return}let e=document.createElement("script");return e.src="https://upload-widget.cloudinary.com/global/all.js",e.async=!0,e.onload=()=>u(!0),document.body.appendChild(e),()=>{}},[]),(0,t.jsx)("button",{type:"button",onClick:()=>{if(!c||!window.cloudinary){alert("Upload widget is still loading. Please try again in a moment.");return}d(!0);let e=window.cloudinary.createUploadWidget({cloudName:o.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME,uploadPreset:o.env.NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET,folder:a,sources:["local","url","camera"],multiple:!1,maxFileSize:1e8,clientAllowedFormats:["jpg","jpeg","png","gif","webp","mp4","mov"],cropping:!1,showSkipCropButton:!0,styles:{palette:{window:"#FFFFFF",windowBorder:"#90A0B3",tabIcon:"#FFA600",menuIcons:"#5A616A",textDark:"#000000",textLight:"#FFFFFF",link:"#FFA600",action:"#FF620C",inactiveTabIcon:"#0E2F5A",error:"#F44235",inProgress:"#FFA600",complete:"#20B832",sourceBg:"#E4EBF1"}}},(a,t)=>{!a&&t&&"success"===t.event&&(r(t.info.secure_url),d(!1),e.close()),a&&(console.error("Upload error:",a),alert("Upload failed. Please try again."),d(!1))});e.open()},disabled:i||!c,className:n+(i||!c?" opacity-50 cursor-not-allowed":""),title:c?"":"Loading upload widget...",children:i?"Uploading...":c?l:"Loading..."})}},8311:function(e,r,a){"use strict";a.d(r,{O:function(){return l}});var t=a(7327);let s="https://fvhgtyexmwcseqrazqkw.supabase.co",o="sb_publishable_2GPFnXEdg1nekNwlG-oQrg_o4QmBg-N";s&&o||console.warn("Supabase credentials missing. Database features will not work.");let l=(0,t.eI)(s,o)},7138:function(e,r,a){"use strict";a.d(r,{default:function(){return s.a}});var t=a(231),s=a.n(t)},6463:function(e,r,a){"use strict";var t=a(1169);a.o(t,"usePathname")&&a.d(r,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}})}},function(e){e.O(0,[231,418,971,23,744],function(){return e(e.s=6535)}),_N_E=e.O()}]);